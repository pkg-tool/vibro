# План переноса из `main` в `master` (строгий оффлайн)

Цель ветки `master`: **полностью оффлайн редактор** — приложение не выполняет сетевые запросы, нет чатов/каналов/коллаборации/звонков/подписок/телеметрии/краш‑репортинга наружу; расширения и любые тулчейны ставятся вручную (без встроенного “скачать/установить”).

## Контекст репозитория (на сейчас)

- Merge-base `master` и `main`: `f13f2dfb70` (2025‑06‑01)
- `main` впереди `master` примерно на: **5423** коммита
- Уникальный коммит `master` поверх базы: `66b98263d5` (брендинг `vector` + выпил части онлайн/соц/AI)

Вывод: cherry-pick “по одному коммиту” практически нереалистичен — нужен перенос уровня “обновить базу до `main` и снова применить offline‑патчи”.

## Рекомендуемая стратегия переноса (практичный вариант)

1) Делать работу в отдельной ветке (например `port/main-into-master-offline`).
2) Обновить базу до `main` (merge или rebase).
3) Повторно применить/обновить patch‑сет “строгий оффлайн”:
   - удалить/загейтить все сетевые/социальные/AI компоненты;
   - убрать любые автоскачивания (расширения, тулчейны, схемы, обновления);
   - сохранить брендинг/пути `vector` (не откатиться к `.zed` и `zed_*`).
4) После сборки — сделать grep‑аудит на остаточные HTTP/WS/telemetry вызовы и удалить/загейтить найденное.

Ниже — три группы, чтобы зафиксировать *что именно считаем переносимым/непереносимым*.

---

# 1) Точно переносим (оффлайн фичи редактора)

Короткие названия → это “домены”, которые можно смело брать из `main`, при условии что они не тянут онлайн‑части.

- Редактор ядро (буферы/курсор/undo)
- UI компоненты (кнопки/меню/панели)
- Поиск/замена
- Файловый менеджер (проект/дерево)
- Файловый поиск (fuzzy/quick open)
- Командная палитра
- Настройки/кеймапы
- Темы/рендеринг
- Терминал (рендер/ввод)
- Markdown (редактор/превью локально)
- SVG превью
- Image превью
- Snippets/шаблоны
- Task runner (локальные задачи)
- LSP локально (через stdio)
- Debugger UI (DAP локально)
- Git локально (diff/commit без hosting)
- Платформенные фиксы (mac/win/linux)
- Перф/память (оптимизации/OOM‑фиксы)

---

# 2) Точно НЕ переносим (сеть/социал/онлайн)

Любое из этого противоречит “строгому оффлайну” и должно быть либо полностью выпилено, либо изолировано так, чтобы **невозможно** было совершить сеть из приложения.

- Коллаборация/присутствие (`collab*`)
- Чаты/каналы (`channel*`)
- Звонки/скриншер (`call*`, `livekit*`, аудио‑события)
- Remote проекты (`remote*`)
- Сетевой слой (`net`, `rpc`, `http_client*`, `reqwest_client`, “cloud client”)
- Cloud API/сервисы (`cloud_*`, `vercel`, docs‑proxy/Cloudflare)
- Телеметрия/краши наружу (`telemetry*`, “crash upload”)
- Автообновления/каналы (`auto_update*`, `release_channel`)
- Extension маркет/скачивание (store/registry/auto‑download)
- Автоустановка тулчейнов (language servers, node, и т.п. “скачать/установить”)
- AI/LLM (агент, Copilot, любые провайдеры: `open_ai`, `anthropic`, `mistral`, `google_ai`, `x_ai`, `open_router`, и т.д.)
- Web search провайдеры
- Логин/подписки/upsell (если появятся)

---

# 3) Под вопросом (нужно решение / требует перепила)

Эти области могут быть полезны редактору, но в `main` часто реализованы через сеть/скачивание — их можно переносить только если заранее договоримся, как именно они будут работать оффлайн.

- Система расширений (только manual install; без маркета/скачиваний)
- Установка языков/тулчейнов (только вручную; UI без “Download”)
- JSON Schema store (только локальные схемы)
- Git hosting UI (GitHub/GitLab интеграции, ссылки/PR) — скорее выпилить
- Devcontainers/remote docker (может подразумевать сеть) — скорее выпилить
- Crash handling (локальные дампы/логи без отправки)
- System specs (сбор инфо только локально)
- CI/Release workflows (не runtime; решаем отдельно)
- Брендинг/ассеты (`.zed` ↔ `.vector`, `zed_*` ↔ `vector_*`) — переносить аккуратно

---

## “Новые crates только в `main`” (для triage)

Список ниже — то, чего в `master` сейчас нет, но есть в `main` (по директориям `crates/*`). Это удобно как чек‑лист при переносе.

### Кандидаты “переносим”

- `action_log` — лог действий
- `keymap_editor` — редактор кеймапов
- `line_ending_selector` — конец строк
- `scheduler` — планировщик
- `settings_json` — JSON настройки
- `settings_macros` — макросы настроек
- `settings_profile_selector` — профили настроек
- `svg_preview` — SVG превью
- `watch` — file watcher
- `which_key` — подсказки хоткеев

### “точно не переносим” (онлайн/соц/AI/сеть)

- `collab`, `collab_ui`
- `call`, `channel`, `livekit_api`, `livekit_client`
- `remote`, `remote_server`, `net`, `rpc`, `client`
- `cloud_api_client`, `cloud_api_types`, `cloud_llm_client`, `vercel`
- `telemetry`, `telemetry_events`
- `feedback`
- `agent*`, `assistant_*`
- `open_router`, `x_ai`, `codestral`, `zeta_prompt`, `web_search_providers`
- `eval*`, `edit_prediction*`, `denoise` (если это часть AI/предикта)

### “под вопросом”

- `json_schema_store` — может тянуть сеть
- `language_onboarding` / `language_models` — часто завязаны на “скачать/установить”
- `onboarding` — может включать онлайн‑флоу
- `system_specs` — часто используется для телеметрии
- `acp_thread` / `acp_tools` — нужно понять назначение (похоже на AI/agent протокол)
- `proto` — нужно проверить, что не для сетевого протокола
- `zed*` / `ztracing*` — потребует адаптации под брендинг/инфру

